<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PGDemo</title>

</head>
<body>
<div id="head" style=" weight:100%; height:30px; background-color: aqua;text-align: left">&nbsp;&nbsp;&nbsp;settle
    accounts
</div>
<div style="text-align: center;">
    <h1>0.01¥ 银行卡支付结算</h1>
    <form action="/pay/placeOrder" method="post">
    <input id="credit" type="radio" name="bankCardType" value="CREDIT_CARD">信用卡&nbsp<input id="deit" type="radio"
                                                                                           name="bankCardType"
                                                                                           value="DEBIT_CARD" checked>借记卡<br>
    &nbsp银行卡号：<input id="cardNumber" type="text" name="number" autocomplete="on"/><br><br>
    &nbsp银行代码：<input id="bankType" type="text" name="bankcode" autocomplete="on"><br><br>
    <div id="cdd" style="display:none">
        银行安全码：<input id="cvv2" type="text"><br><br>
        银行有效期：<input id="valid" type="text"><br><br>
    </div>
    &nbsp&nbsp&nbsp&nbsp持卡人：<input id="name" type="text" name="payername" autocomplete="on"/><br><br>
    &nbsp身份证号：<input id="idNumber" type="text" name="citizenIdNumber" autocomplete="on"/><br><br>
    银行预留手机号：<input type="text" id="phone" name="phone" autocomplete="on"/>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<br><br>
    &nbsp&nbsp&nbsp验证码：<input id="verifyCode" type="text" name="verifyCode" autocomplete="on"/><br><br>
    </form>
    <button id="verify" value="获取验证码" style="width: 90px;height:30px;background-color: cadetblue;border: 0">获取验证码
    </button>
    <button id="confirm" style="width: 90px;height:30px;background-color: cadetblue;border: 0">确认支付</button>
</div>

</body>


<script src="https://cdn.bootcss.com/jquery/2.2.2/jquery.min.js"></script>
<script>

    $("#credit").on("click", function () {
        $("#cdd").show();
    });
    $("#deit").on("click", function () {
        $("#cdd").hide();
    });
    var bankcard = new Object();
    $("#verify").on("click", function () {
        bankcard.number = $("#cardNumber").val();
        bankcard.holderIdNumber = $("#idNumber").val();
        bankcard.holderName = $("#name").val();
        bankcard.holderPhone = $("#phone").val();
        bankcard.holderIdType = "IDENTITY_CARD";
        var payer = new Object();
        payer.payment_method = $("input[name='bankCardType']:checked").val();
        if (payer.payment_method == "CREDIT_CARD") {
            bankcard.cvv2 = $("#cvv2").val();
            bankcard.validDate = $("#valid").val();
        }
        bankcard.bankCode = $("#bankType").val().toUpperCase();

        $.ajax({
            type: 'POST',
            url: "pay/placeOrder",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(bankcard),
            success: function () {
                alert("填写验证码");
            },
            error: function (err) {
                console.log(err);
            }
        });
    });

    $("#confirm").on("click", function () {
        var verify_code = $("#verifyCode").val();
        $.ajax("pay/confirm", {
            method: "POST",
            contentType: "text/xml; charset=utf-8",
            data: verify_code,
            dataType: "json",
            success: function (data) {
                alert("success");
                console.log(data);
            },
            error: function (err) {
                console.log(err);
            }
        })

    });
</script>
</html>
